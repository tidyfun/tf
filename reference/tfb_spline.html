<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Represent curves as a weighted sum of spline basis functions."><title>Spline-based representation of functional data — tfb_spline • tf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spline-based representation of functional data — tfb_spline"><meta property="og:description" content="Represent curves as a weighted sum of spline basis functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyfun/tf">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyfun/tf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spline-based representation of functional data</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidyfun/tf/blob/HEAD/R/tfb-spline.R" class="external-link"><code>R/tfb-spline.R</code></a></small>
      <div class="d-none name"><code>tfb_spline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Represent curves as a weighted sum of spline basis functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tfb_spline</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  id <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arg <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for list</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for tfd</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for tfb</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">tfb_spline</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  arg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  global <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>a <code>matrix</code>, <code>data.frame</code> or <code>list</code> of suitable shape, or another
<code>tf</code>-object containing functional data.</p></dd>


<dt>...</dt>
<dd><p>arguments to the calls to <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code> setting up the basis and
<code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.fit.html" class="external-link">mgcv::gam.fit()</a></code> (if <code>penalized</code> is TRUE). If not
user-specified here, this uses <code>k = 25</code> cubic regression spline basis
functions (i.e., <code>bs = "cr"</code>) by default, but should be set appropriately
by the user. See also Details and examples in the vignettes.</p></dd>


<dt>id</dt>
<dd><p>The name or number of the column defining which data belong to
which function.</p></dd>


<dt>arg</dt>
<dd><p><code>numeric</code>, or list of <code>numeric</code>s. The evaluation grid.
For the <code>data.frame</code>-method: the
name/number of the column defining the evaluation grid. The <code>matrix</code> method
will try to guess suitable <code>arg</code>-values from the column names of <code>data</code> if
<code>arg</code> is not supplied. Other methods fall back on integer sequences
(<code>1:&lt;length of data&gt;</code>) as the default if not provided.</p></dd>


<dt>value</dt>
<dd><p>The name or number of the column containing the function
evaluations.</p></dd>


<dt>domain</dt>
<dd><p>range of the <code>arg</code>.</p></dd>


<dt>penalized</dt>
<dd><p>default <code>TRUE</code> estimates regularized/penalized basis coefficients via <code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code>,
set <code>FALSE</code> for ordinary least squares/ML estimators.</p></dd>


<dt>global</dt>
<dd><p>Defaults to <code>FALSE</code>. If <code>TRUE</code> and <code>penalized = TRUE</code>, all
functions share the same smoothing parameter (see Details).</p></dd>


<dt>verbose</dt>
<dd><p>defaults to outputting statistics about the fit achieved by the basis</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>tfb</code>-object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The basis to be used is set up via a call to <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code> and all the spline
bases discussed in <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">mgcv::smooth.terms()</a></code> are available, in principle.
Depending on the value of the <code>penalized</code>- and <code>global</code>-flags, the
coefficient vectors for each observation are then estimated via fitting a GAM
(separately for each observation, if <code>!global</code>) via <code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> (least
square error, the default) or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code> (if a <code>family</code> argument was
supplied) or unpenalized least squares / maximum likelihood.</p>
<p>After the "smoothed" representation is computed, the amount of smoothing that
was performed is reported in terms of the "percentage of variability
preserved", which is the variance (i.e, the explained deviance, in the general
case) of the smoothed function values divided by the variance of the original
values (the null deviance, in the general case). Reporting can be switched off
with <code>verbose = FALSE</code>.</p>
<p>The <code>...</code> arguments supplies arguments to both the
spline basis (via <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>) and the estimation (via
<code><a href="https://rdrr.io/pkg/mgcv/man/magic.html" class="external-link">mgcv::magic()</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code>), most important:</p><ul><li><p>how many basis functions <code>k</code> the spline basis should have, the default is</p></li>
</ul><ol><li><p></p></li>
</ol><ul><li><p>which type of spline basis <code>bs</code> should be used, the default is cubic
regression splines (<code>"cr"</code>) - a <code>family</code>-argument to the fitters for data for
which squared errors are not a reasonable criterion for the representation
accuracy (see <code><a href="https://rdrr.io/pkg/mgcv/man/family.mgcv.html" class="external-link">mgcv::family.mgcv()</a></code> for what's available).</p></li>
<li><p>an <code>sp</code>-argument for manually fixing the amount of smoothing (see
<code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">mgcv::s()</a></code>), which (drastically) reduces the computation time.</p></li>
</ul><p>If <strong><code>global == TRUE</code></strong>, the routine first takes a subset of curves (10\<!-- % of -->
curves sampled deterministically, at most 100, at least 5) on which smoothing
parameters per curve are estimated and then uses the mean of the log
smoothing parameter of those for all curves. This can be much faster than
optimizing the smoothing parameter for each curve on large datasets. For very
sparse data, estimating a common smoothing parameter directly for all curves
at once might yield better results, this is <em>not</em> what's implemented here.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>
    
<ul><li><p><code>tfb_spline(data.frame)</code>: convert data frames</p></li>
<li><p><code>tfb_spline(matrix)</code>: convert matrices</p></li>
<li><p><code>tfb_spline(numeric)</code>: convert matrices</p></li>
<li><p><code>tfb_spline(list)</code>: convert lists</p></li>
<li><p><code>tfb_spline(tfd)</code>: convert <code>tfd</code> (raw functional data)</p></li>
<li><p><code>tfb_spline(tfb)</code>: convert <code>tfb</code>: modify basis representation, smoothing.</p></li>
<li><p><code>tfb_spline(default)</code>: convert <code>tfb</code>: default method, returning prototype
when data is missing</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">mgcv::smooth.terms()</a></code> for spline basis options.</p>
<p>Other tfb-class: 
<code><a href="fpc_wsvd.html">fpc_wsvd</a>()</code>,
<code><a href="tfb.html">tfb</a></code>,
<code><a href="tfb_fpc.html">tfb_fpc</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fabian Scheipl, Jeff Goldsmith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

